<project name="concurrent_engine" default="dist" basedir="../">

	<!-- set global properties for this build -->
	<property name="conf" value="conf"/>
	<property name="dist"  value="deploy"/>
	<property name="libs" value="libs"/>
	<property name="scripts" value="scripts"/>
	<property name="src" value="src"/>
	<property name="stage" value="target"/>
	<property name="build" value="${stage}/classes"/>


	<!-- Properties for the deployable files -->
	<property name="deploy_jar" value="${ant.project.name}.jar"/>

	<!-- Grab the system properties here  -->
	<property environment="env"/>

	<!-- Classpath for the compilations-->
	<path id="project.classpath">
		<fileset dir="${libs}" includes="*.jar"/>
		<fileset dir="${libs}" includes="*.zip"/>
	</path>

	<target name="init">
		<!-- Create the staging directory structure  -->
		<mkdir dir="${dist}"/>
		<mkdir dir="${stage}"/>
		<mkdir dir="${stage}/classes"/>
	</target>

	<target name="compile" depends="init">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac
			srcdir="${src}"
			destdir="${build}"
			classpathref="project.classpath"
			excludes="com/advpcs/rebatebilling2/test/**"
			source="1.3"
			debug="true"
		/>
	</target>

	<target name="buildjar" depends="compile">
		<jar jarfile="${stage}/${deploy_jar}">
			<fileset dir="${build}"/>
			<zipfileset dir="${src}" prefix="src"/>
		</jar>
	</target>

	<target name="dist" depends="clean, buildjar">
		<copy file="${stage}/${deploy_jar}" todir="${dist}"/>
		<antcall target="pfizer"/>
	</target>

	<target name="dist.pfizer" depends="pfizer"/>
	
	<target name="clean" description="Clean build and distribution directories">
		<delete dir="${stage}"/>
	</target>

	<target name="compilePfizer" depends="init">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac
			srcdir="${src}"
			destdir="${build}"
			classpathref="project.classpath"
			source="1.3"
			debug="true"
		/>
		<jar jarfile="${stage}/${deploy_jar}">
			<fileset dir="${build}"/>
			<zipfileset dir="${src}" prefix="src"/>
		</jar>
	</target>

	<target name="pfizer" depends="compilePfizer">
		<copy file="${stage}/${deploy_jar}" tofile="${dist}/pfizer_combined_ncpdp.jar"/>
	</target>

</project>

