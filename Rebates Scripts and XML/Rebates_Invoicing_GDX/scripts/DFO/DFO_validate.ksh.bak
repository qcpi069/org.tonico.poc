echo "`date +'%b %d, %Y %H:%M:%S'`:Validation of"  \
     "fields of claims records starting......"

MAIL_SUBJECT=""
MAIL_BODY_FILE=""

>$MAILFILE

#===================================================================
#FUCNTION mailto_IS_group
#===================================================================

  function mailto_IS_group {

     echo "E-mailing to IS group...."

     MAILTO=`cat $SUPPORT_MAIL_LIST_FILE`

     $SCRIPT_DIR/DFO_mail.ksh   \
             "$MAILTO"          \
             "$MAIL_SUBJECT"    \
             "$MAILFILE"

     echo "IS group was e-mailed"

  }

#===================================================================
#FUNCTION mail_to_contract_admin_group
#===================================================================

  function mail_to_contract_admin_group {

     echo "E-mailing to contract admin group...."

     MAILTO=`cat $CONTRACT_ADMIN_MAIL_LIST_FILE`

     cat $MAIL_BODY_FILE                    | \
         sed s/CLIENT_NAME/$CLIENT_NAME/    | \
         sed s/MONTH/$PROCESS_MONTH/        | \
         sed s/YEAR/$PROCESS_YEAR/            \
     > $MAILFILE

     $SCRIPT_DIR/DFO_mail.ksh   \
             "$MAILTO"          \
             "$MAIL_SUBJECT"    \
             "$MAILFILE"

     echo "Contract admin group was e-mailed...."

  }

#===================================================================

  dd_ICLMS="$IN_DATA_FILE"
  dd_IREJC="$IN_REJ_COUNT_REF"
  dd_IPRCMTH="$PROCESS_MONTH_PARM_FILE"
  dd_IEREF="$ERROR_DESC_FILE"
  dd_OCLMS="$OUT_DATA_FILE"
  dd_OREJ="$BAD_FILE"
  dd_OLOG="$DATA_LOG_FILE"
  dd_OREJC="$OUT_REJ_COUNT_REF"
  dd_OCCON="$CONTRACT_FILE"
  
  export dd_ICLMS dd_IREJC dd_IPRCMTH dd_IEREF dd_OCLMS dd_OREJ dd_OLOG dd_OREJC dd_OCCON
  
  cobrun '$EXE_DIR/validate.int' 
  
#===================================================================

  RETURN_CODE=$?
  
  if [[ -s $dd_OLOG ]] then
  
     cat $dd_OLOG
  
     echo "Script: 'DFO_validate.ksh'"                           \
          "\nProcessing for $CLIENT_NAME Failed: `cat $dd_OLOG`" \
          "\nLook for Log file $LOG_FILE" > $MAILFILE
  
     MAIL_SUBJECT="DFO PROCESS"
  
     mailto_IS_group
  
     if [[ -n "`grep '2%' $dd_OLOG`" ]] then
  
        MAIL_BODY_FILE="$TWO_PERCENT_MAIL_BODY"
  
        mail_to_contract_admin_group

     else
  
        if [[ -z "`grep -i 'paragraph' $dd_OLOG`" ]] then

           MAIL_BODY_FILE="$INVALID_FILE_MAIL_BODY"

           mail_to_contract_admin_group

        fi
  
     fi
  
  
     exit 200
  
  else
  
     if [[ $RETURN_CODE != 0 ]] then
  
         MAIL_SUBJECT="DFO SCRIPT EXECUTION ERROR"
         echo "DFO script 'DFO_validate.ksh'"   \
              "execution error occurred" > $MAILFILE
  
         mailto_IS_group
  
     fi
  
  fi
  
  echo "\nNo. of records processed: `wc -l $dd_ICLMS | cut -f1 -d '/'`"   \
       "\nNo. of records accepted : `wc -l $dd_OCLMS | cut -f1 -d '/'`"   \
       "\nNo. of records rejected : `wc -l $dd_OREJ | cut -f1 -d '/'`"    \
  
  
  echo "`date +'%b %d, %Y %H:%M:%S'`:Validation of"  \
       "fields of claims records done......"
  
  exit 0
  
  
