

<sqml>
	<property name="TIMEOUT" value="0"/>
	<datasources resource="datasource.xml"/>
	<properties resource="datamart.properties"/>

    <command type="java"><![CDATA[
        mailto=script.getProperty("mailto");
        cli_schema=script.getProperty("cli_schema");        
	]]></command>
		       
	<command type="try">
		<try>
			<command type="copy" batch="1000">
				<source type="sql" datasource="datamart"><![CDATA[
select CLAIM_GID, PERIOD_ID, EXTNL_LVL_ID1, EXTNL_LVL_ID2, RBATE_ID, DSPND_DATE,
	rbate_access + rbate_mrkt_shr + RBATE_ADMIN_FEE, NDC
from rps.tapc_detail_${QPARM}
where period_id='${QPARM}' and rbate_id = '${RBATE}'
and EXCPT_STAT='R'
				]]></source>
				<target
					type             = "sql"
					datasource       = "datamart"
					transaction      = "true"
					batch            = "1000"
					reportInterval   = "1000"
					queryTimeout     = "${TIMEOUT}"
				><![CDATA[
					INSERT INTO rps.BCBS_report
					 (CLAIM_GID,
					  INV_QTR,
					  EXTNL_LVL_ID1,
					  EXTNL_LVL_ID2,
					  REBATE_ID,
					  FILL_DT,
					  INVOICE_AMT,
					  NDC
					  ) 
					VALUES ( ?,?,?,?,?,?,?,? )
				]]></target>
			</command>

		</try>
		<catch>
		</catch>
	</command>
</sqml>
