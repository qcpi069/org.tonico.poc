<statements>
	
	<property name="schema" value="VRAP"/>

	<!-- ................................Harvest Tables............................... -->
	<group name="HarvestTables">
		<statement name="DEL_TDISCNT_EXT_CLAIM"><![CDATA[
			DELETE FROM VRAP.TDISCNT_EXT_CLAIM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDISCNT_EXCL_EXT_CLAIM"><![CDATA[
			DELETE FROM VRAP.TDISCNT_EXCL_EXT_CLAIM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TMKTSHR_EXT_CLAIM"><![CDATA[
			DELETE FROM VRAP.TMKTSHR_EXT_CLAIM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TMKTSHR_EXCL_EXT_CLAIM"><![CDATA[
			DELETE FROM VRAP.TMKTSHR_EXCL_EXT_CLAIM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDTLSUM_EXCL_EXT_CLAIM"><![CDATA[
			DELETE FROM VRAP.TDTLSUM_EXCL_EXT_CLAIM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TMKTSHR_CLAIM_SUM"><![CDATA[
			DELETE FROM VRAP.TMKTSHR_CLAIM_SUM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDISCNT_MKSR_SUM"><![CDATA[
			DELETE FROM VRAP.TDISCNT_MKSR_SUM_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDISCNT_MKSR_PCT"><![CDATA[
			DELETE FROM VRAP.TDISCNT_MKSR_PCT_#MODEL#
			WHERE PERIOD_ID = '#PERIOD#' AND
			DISCNT_RUN_MODE_CD = '#DRM#' AND
			HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDISCNT_RPT_DRUG"><![CDATA[
			DELETE FROM VRAP.TDISCNT_RPT_DRUG_#MODEL#
			 WHERE HVST_ID = #HVST_ID#
                           AND PERIOD_ID = '#PERIOD#'
                           AND DISCNT_RUN_MODE_CD = '#DRM#'
		]]></statement>	
		<statement name="DEL_TDISCNT_RPT_DRUG_TIER"><![CDATA[
			DELETE FROM VRAP.TDISCNT_RPT_DRUG_TIER_#MODEL#
			 WHERE HVST_ID = #HVST_ID#
                           AND PERIOD_ID = '#PERIOD#' 
                           AND DISCNT_RUN_MODE_CD = '#DRM#'
		]]></statement>	
	</group>
	<!-- ................................Allocation Tables................................ -->
	<group name="AllocationTables">
		<statement name="DEL_TDISCNT_SUM"><![CDATA[
			DELETE FROM VRAP.TDISCNT_SUM_#MODEL#
			WHERE PERIOD_ID IN (#PERIOD#)
			AND   RUN_MODE_CD = #RMC#
			AND   HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TDISCNT_EXCL_SUM"><![CDATA[
			DELETE FROM VRAP.TDISCNT_EXCL_SUM_#MODEL#
			WHERE PERIOD_ID IN (#PERIOD#)
			AND   RUN_MODE_CD = #RMC#
			AND   HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TMKTSHR_EXCL_SUM"><![CDATA[
			DELETE FROM VRAP.TMKTSHR_EXCL_SUM_#MODEL#
			WHERE PERIOD_ID IN (#PERIOD#)
			AND   RUN_MODE_CD = #RMC#
			AND   HVST_ID = #HVST_ID#
		]]></statement>
		<statement name="DEL_TMKTSHR_SUM"><![CDATA[
			DELETE FROM VRAP.TMKTSHR_SUM_#MODEL#
			WHERE PERIOD_ID IN (#PERIOD#)
			AND   RUN_MODE_CD = #RMC#
			AND   HVST_ID = #HVST_ID#
		]]></statement>
	</group>
	<!-- .........................................SHARED.................................... -->
	<group name="Shared">
		<statement name="GET_REPORT_IDS_FROM_HARVEST_QUEUE"><![CDATA[
			SELECT HQ.RPT_ID,
				   HQ.PERIOD_ID,
				   HQ.DISCNT_RUN_MODE_CD,
				   C.MODEL_TYP_CD,
				   HQ.HVST_ID,
				   HQ.INV_SEQ_NB,
				   HQ.INV_ID,
				   HQ.VER_SEQ_NB
			FROM VRAP.THARVEST_QUE HQ,
			     VRAP.TRPT_REQMT RR,
			     VRAP.THIERARCHY H,
			     VRAP.TCNTRCT C
			WHERE HQ.RPT_ID = RR.RPT_ID AND
			      RR.HRCY_ID = H.HRCY_ID AND
			      H.CNTRCT_ID = C.CNTRCT_ID AND
			      HQ.HVST_STAT_CD = 2
			ORDER BY HQ.RPT_ID ASC,
					 HQ.PERIOD_ID ASC,
					 HQ.DISCNT_RUN_MODE_CD ASC,
					 HQ.VER_SEQ_NB DESC
			WITH UR
		]]></statement>
		<statement name="GET_SNAP_DETAILS_FOR_REPORT_VERSION"><![CDATA[
			SELECT COUNT(*) AS COUNT
			FROM VRAP.TSNAP_DTL SD
			WHERE SD.HVST_ID = ? AND
				  SD.STAT_CD = 1
			WITH UR
		]]></statement>
		<statement name="GET_HQ_STAT_CODE_CHECK"><![CDATA[
			SELECT COUNT(*) AS COUNT
			FROM VRAP.THARVEST_QUE HQ
			WHERE HQ.HVST_STAT_CD = 1
			WITH UR
		]]></statement>		
		<statement name="GET_BASE_ALLOCATION_CHECK"><![CDATA[
			SELECT COUNT(*) AS COUNT
			FROM VRAP.TSNAP S, VRAP.TSNAP_DTL SD
			WHERE S.SNAP_ID = SD.SNAP_ID AND
			      S.SNAP_SEQ_NB = -1 AND
			      SD.STAT_CD = 1 AND
			      SD.HVST_ID = ?
			WITH UR
		]]></statement>		
	</group>
</statements>
